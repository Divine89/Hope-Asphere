You are a senior full-stack architect and startup CTO.

Build a production-ready Airbnb-like rental marketplace web application.

App Name: Home-Asphere

Business Model:
Home-Asphere is a two-sided rental marketplace where:
- Hosts list properties for short-term stays.
- Guests search and book properties.
- Platform earns 12% commission per booking.

Architecture Requirements:

Frontend:
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- ShadCN UI
- Deployed on Vercel

Backend:
- Next.js Serverless API Routes (Vercel Functions)
- Prisma ORM
- REST API structure

Database:
Option 1: Amazon Aurora PostgreSQL
Option 2: Supabase (PostgreSQL)
Use Prisma schema compatible with both.

Storage:
- AWS S3 for image uploads
- Presigned URL upload flow

Payments:
- Razorpay integration
- Webhook verification
- Platform commission logic
- Booking confirmation after payment verification

Maps:
- Google Maps API for property location
- Lat/Long storage
- Map-based search

Authentication:
- NextAuth
- Email + Password
- Google OAuth
- Role-based (Guest, Host, Admin)

Core Features:

1. Authentication
- Sign up / Login
- Role selection
- Protected routes
- JWT session handling

2. User Profile
- Profile image
- Bio
- Contact
- Booking history
- Host earnings dashboard

3. Property Listing (Host Side)
- Create/Edit/Delete listing
- Upload multiple images (S3)
- Price per night
- Amenities
- Availability calendar
- Location with map picker
- Max guests

4. Search & Filters (Guest Side)
- Search by city
- Filter by:
  - Price range
  - Amenities
  - Rating
  - Guests
- Sort by price / rating
- Map-based result display

5. Booking System
- Date range selection
- Prevent double booking
- Night calculation
- Platform fee calculation
- Razorpay payment integration
- Payment success webhook
- Booking status:
  - Pending
  - Confirmed
  - Cancelled
  - Refunded

6. Reviews
- Guests review after stay
- 1-5 rating
- Host reply
- Average rating auto-calculation

7. Admin Panel
- View all users
- Suspend users
- View all bookings
- Revenue analytics
- Commission tracking
- Basic dashboard metrics

8. Notifications
- Email booking confirmation
- Host notification on new booking
- Cancellation alerts

9. Security
- Input validation (Zod)
- Rate limiting
- CSRF protection
- Secure S3 upload
- Webhook signature verification
- Environment variable management

Database Schema:
Provide full Prisma schema for:

- User
- Listing
- Image
- Booking
- Review
- Payment
- Amenity
- Availability
- Wishlist
- AdminLogs

Also provide:
- ER diagram explanation
- Folder structure
- API route examples
- Razorpay integration example
- S3 upload flow
- Middleware example
- Protected route example
- Webhook handler example

Deployment Steps:
- Deploy to Vercel
- Connect Aurora PostgreSQL
- Setup environment variables
- Setup S3 bucket
- Setup Razorpay webhooks

Performance Optimization:
- Image optimization
- Caching strategy
- Server-side rendering where needed
- Edge functions suggestion

SEO Optimization:
- Dynamic metadata
- Sitemap
- Structured data

Finally provide:
- Step-by-step local setup guide
- MVP build roadmap (30 days)
- Cost estimation (Vercel + Aurora + S3)
- Scaling plan (1k â†’ 100k users)